                                                  Практична робота 2
                                                  
Мета роботи: Навчитися створювати запити до бази даних з використанням умови WHERE, виконувати багатотабличні запити, застосовувати різні види JOIN для об'єднання даних із кількох таблиць, а також використовувати складні умови фільтрації.

                                             Варіант №20 (ДАІ)
База даних повинна містити інформацію про дорожньо-транспортні
подіях (ДТП). Про ДТП має бути відомо вид ДТП, які транспортні засоби в ньому брали участь (можливо більше двох), їх державні номери, П.І.Б., домашні адреси водіїв цих транспортних засобів, а також номери посвідчень водія. Крімтого, необхідно знати кількість постраждалих у даній ДТП, вид травми, П.І.Б., домашня адреса та номер паспорта кожного потерпілого. Постраждалими можуть бути водії. У ДТП можуть брати участь і пішоходи, про які потрібно знати, чи не є вони постраждалими, а також їх П.І.Б., домашню адресу та номер паспорта. Про ДТП також мають бути відомі місце, дата, час, винуватець ДТП та які міліціонери (їх звання та П.І.Б.) виїжджали ДТП.
                          
                                Запити
        •	Вивести повний список ДТП, які виникли з вини пішоходів, за вказаний
        період з повними відомостями про них;
        •	Знайти місце, де сталася максимальна кількість ДТП;
        •	Вивести повний список ДТП, на які ВИЇжджали міліціонери із зазначеним
        званням за вказаний період часу, з повними відомостями про ДТП;
        •	Скласти список водіїв, які брали участь більше НІЖ В ОДНІЙ ДТП за
        зазначений період часу, З повними відомостями про цих водіїв;
        •	Скласти список постраждалих у ДТП за вказаний період часу з
        повними відомостями про ці ДТП, упорядковані за кількістю травм певного виду.
        •	Внести відомості про нову ДТП;
        •	Видалити відомості про ДТП, які сталися раніше вказаної дати.

                            
                        Логічна та фізична модель
![image](https://github.com/user-attachments/assets/f28b2ca6-c263-4cf1-8a6b-23382d8fbcb9)

![image](https://github.com/user-attachments/assets/96d46b57-0b9a-4983-97ca-c6d99bad622c)


                          Бізнес-правила для системи ДАІ
1.	Максимальна довжина моделі транспортного засобу - 50 символів.
2.	Максимальна довжина державного номера транспортного засобу - 10 символів.
3.	Кожне ДТП повинно мати хоча б одного призначеного міліціонера.
4.	Максимальна довжина адреси місця ДТП - 100 символів.
5.	Інформація про травму завжди повинна бути прив'язана до конкретного постраждалого.
6.	Максимальна довжина опису типу травми - 100 символів.
7.	Кожний постраждалий повинен бути зареєстрований в конкретному ДТП.
8.	Максимальна довжина звання міліціонера - 30 символів.
9.	В одному ДТП може брати участь декілька транспортних засобів.
10.	Максимальна довжина номера посвідчення водія - 10 символів.
11.	Максимальна довжина номера паспорта - 9 символів.
12.	Тип ДТП повинен бути обов'язково вказаний.
13.	Один водій може керувати тільки одним транспортним засобом в момент ДТП.
14.	Максимальна довжина ПІБ учасників - 50 символів для кожного компонента.

![image](https://github.com/user-attachments/assets/0e9477f5-6059-49af-baa0-298eb00f04e3)

![image](https://github.com/user-attachments/assets/7fef6939-023b-4d04-bbd6-6684da0d1c5e)


Завдання 2:
 ![image](https://github.com/user-attachments/assets/ede721a9-0b3b-4876-b804-b98cf12a5be5)
![image](https://github.com/user-attachments/assets/70426e4e-f033-46c9-9392-5542e0136d26)
![image](https://github.com/user-attachments/assets/939a9c65-ea86-48f7-a4ea-b14485005f9f)
![image](https://github.com/user-attachments/assets/6cbbbacc-459c-4d75-af80-4e3493b5faf2)
![image](https://github.com/user-attachments/assets/58157818-dc36-4412-82e2-79c4fa4d3a5f)

Рисунок 3-7 –успішне додавання по 100 записів у таблиці.

Завдання 3: Використання оператора WHERE
Виведення всіх ДТП, у яких постраждало більше двох осіб:
SELECT * FROM Accident WHERE Victim_Count > 2;
 ![image](https://github.com/user-attachments/assets/74a0417b-965c-4ae1-b016-c273636d2067)
 
Рисунок 8 – результат завдання 3.

Завдання 4: Використання логічних операторів у WHERE
Виведення ДТП з більш ніж двома постраждалими, якщо розслідування ще не закрито:
SELECT * FROM Accident 
WHERE Victim_Count > 2 
AND Investigation_Status = 'Open';
 ![image](https://github.com/user-attachments/assets/518beb23-defe-4b3c-bc23-9fce3ed3e063)
 
Рисунок 9 – результат завдання 4.

Завдання  5: Використання оператора LIKE
Виведення ДТП, які сталися на вулицях, назви яких закінчуються на "Street" або "St":
SELECT * FROM Accident 
WHERE Location LIKE '% Street' 
OR Location LIKE '% St';
![image](https://github.com/user-attachments/assets/08210964-67ae-455b-ab4f-9069d404a27b)

Рисунок 10 – результат завдання 5.

Завдання 6:Використання INNER JOIN
Виведення всіх ДТП разом з іменами постраждалих:
SELECT A.*, V.LastName AS Victim_LastName, V.FirstName AS Victim_FirstName
FROM Accident A
INNER JOIN Victim V ON A.ID_Accident = V.ID_Accident;
![image](https://github.com/user-attachments/assets/9b01e87a-5dd9-4aaa-80ab-e559f6d33156)

Рисунок 11 – результат завдання 6.

Завдання 7: Використання LEFT JOIN
Виведення всіх ДТП іменами постраждалих (якщо є, якщо немає — NULL):
SELECT A.*, 
       COALESCE(V.LastName, 'No Victim') AS Victim_LastName, 
       COALESCE(V.FirstName, 'No Victim') AS Victim_FirstName
FROM Accident A
LEFT JOIN Victim V ON A.ID_Accident = V.ID_Accident; 
![image](https://github.com/user-attachments/assets/c8923499-35d1-4284-a342-b65b3e12587f)

Рисунок 12 – результат завдання 7.

Завдання 8: Використання вкладеного запиту (SUBQUERY)
Виведення ДТП, у яких є хоча б один потерпілий (постраждалий) із тяжкими травмами:
SELECT * 
FROM Accident 
WHERE EXISTS (
    SELECT 1 
    FROM Victim 
    WHERE Victim.ID_Accident = Accident.ID_Accident
    AND Victim.Severity = 'Severe');
 ![image](https://github.com/user-attachments/assets/566a999f-d373-4022-a4d8-7cea5572c613)
Рисунок 13 – результат завдання 8.

Завдання 9: Використання GROUP BY та HAVING
Підрахунок кількості ДТП за їх типами, якщо таких випадків більше 1:
SELECT Accident_Type, COUNT(*) AS Total_Accidents 
FROM Accident 
GROUP BY Accident_Type 
HAVING COUNT(*) > 1;
 ![image](https://github.com/user-attachments/assets/e9a0d7b2-063b-49ac-a3da-bddca639d689)
 
Рисунок 14 – результат завдання 9.

Завдання 10: Складний багатотабличний JOIN
Виведення ДТП, жертв і водіїв (для кожного ДТП — всі водії, якщо є потерпілі):
SELECT A.*, 
       V.LastName AS Victim_LastName, 
       V.FirstName AS Victim_FirstName, 
       D.LastName AS Driver_LastName, 
       D.FirstName AS Driver_FirstName
FROM Accident A
JOIN Victim V ON A.ID_Accident = V.ID_Accident
JOIN Driver_Involvement DI ON A.ID_Accident = DI.ID_Accident
JOIN Driver D ON DI.ID_Driver = D.ID_Driver
WHERE A.Victim_Count > 1;
 ![image](https://github.com/user-attachments/assets/4b8f0f60-6c44-4f6f-b84b-e796c6b5f7ee)
 
Рисунок 15 – результат завдання 10.

Завдання 11: WHERE у поєднанні з JOIN
Виведення всіх відкритих ДТП разом з іменами постраждалих:
SELECT A.*, 
       V.LastName AS Victim_LastName, 
       V.FirstName AS Victim_FirstName
FROM Accident A
JOIN Victim V ON A.ID_Accident = V.ID_Accident
WHERE A.Investigation_Status = 'Open';
 ![image](https://github.com/user-attachments/assets/5f6a1f18-144b-43b7-bb97-3ea1d0517a4e)
 
Рисунок 16 – результат завдання 11.
                              
Висновки: 
У ході виконання роботи я навчилася формувати запити до бази даних із використанням умови WHERE, що дозволяє здійснювати селекцію даних за заданими критеріями. Освоїла застосування логічних операторів AND, OR, NOT для побудови складних умов фільтрації.
Я також працювала з багатотабличними запитами, використовуючи різні види JOIN (INNER JOIN, LEFT JOIN), що дало змогу об’єднувати дані з декількох таблиць та отримувати комплексну інформацію про ДТП, їх учасників та наслідки.
Крім того, я застосувала вкладені запити (SUBQUERY) для реалізації складних вибірок, а також оператори GROUP BY та HAVING для групування даних і отримання статистичних підсумків.
Таким чином, у ході виконання роботи я здобула навички роботи з SQL-запитами різного рівня складності, що є важливим для ефективного аналізу та обробки інформації в реляційних базах даних.

